# MtsCloud "Проект для студента poshta69" K8s namespase "sre-cource-student-72"

Нагрузочное тестирование WEB API - mts-sre.app

В качестве инструмента тестирования выбран [Artillery](https://www.artillery.io/docs).
Из преимуществ: 
    - имеет декларативный язык написания тестов (YAML)
    - поддержку плагинов
    - метрики и отчеты

Установка и использование инструмента

   - [Artillery](https://www.artillery.io/docs/get-started/get-artillery)
   - создать файл сценария
   - запустить тестирование
  ```
  artillery run test.yml>
  ```

# Анамнез

схема приложения

Легенда.
Тестировать будем виджет погоды на региональном новостном сайте "Тамбовский вестник", ариложение содержит в себе погодные данные городов области, наполнение данными происходит автоматически или оператором несколько раз в день. Из этого можем предположить, что нам потребуется найти максимальное число GET запросов при том, что  POST запросов будет менее 1% - MaxPerformanceTest тест. Далее возьмем 90-95% от максимальной нагрузки и проведем стрес тест - StressTest. По результатам тестов прощетаем стабильную нагрузку укладывающуюся до 80% от MaxPerformance системы - StabilityTest.
Для выполнения тестирования нам потребуются следующие данные:
- Headers:
    -`'Host: mts-sre.app'`

- Endpoints - GET:
   - `/WeatherForecast` - прогноз погоды по всем городам (аналагичен Forecast, только Forecast еще используется для обновления/добавления прогноза)
   - `/Cities` - список всех городов
   - `/Cities/{id}` - конкретный город
   - `/Forecast` - прогноз по всем городам
   - `/Forecast/{id}` - конкретный прогноз

- Endpoints - POST:
   - `/Cities` - добавить город
   - `/Cities/{id}` - изменить конкртный город
   - `/Forecast/{cityId}` - прогноз для города
   - `/Forecast/{id}` - изменить конкретный прогноз

# Требования по производительности к системе (SLO/SLA)
`SLA:`
- http.response_time.p99: < 800 mc
- http.response_time.p95: < 500 mc
- http.maxErrorRate: < 2%

`SLO:`
- http.response_time.p99: < 700 mc
- http.response_time.p95: < 400 mc
- http.maxErrorRate: < 1%

# Профили нагрузки:

- #### MaxPerformanceTest
  * Описание: Постепенное увеличение нагрузки до критической.
  * Цели: Поиск максимума нагрузки RPS, поиск узкого места, происк точки отказа.
  * Методы: GET (WeatherForecast) от 0 до 100%
  * Методы: POST Cities 50 RPS

- #### StressЕest
  * Описание: Постепенное увеличение нагрузки до 90% от максимума. Поддержание нагрузки 1 x Max Load time.
  * Цели: Проверка выполнения SLO за расчетное время под нагрузкой 90% от максимума 1 x Max Load time.
  * Методы: GET (WeatherForecast) 90% от MAXRPS
  * Методы: POST Cities 50 RPS

- #### StabilityTest
  * Описание: Постепенное увеличение небольшой нагрузки на все эндпоинты API. Поддержание нагрузки 1 x Max Load time.
  * Цели: Проверка работы всех эндпоинтов API на ошибки при соблюдении SLA/SLO. 
  * Методы: GET/POST (ALL)

# Отчет о тестировании:
